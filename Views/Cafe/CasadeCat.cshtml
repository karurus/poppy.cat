@{
    ViewBag.Title = "Booking";
}
<h2> Casa de Cat </h2>
<!DOCTYPE html>
<html>
<head>
    <metaname ="viewport" content="width=device-width" />
    <title></title>
</head>
<body>
    @{
        int price = 440;
        int timedDiff = 1;
    }
    <div class="container-fluid" style="border:1px solid #cecece;">
        <div class="row col-md-6">
            <br />
            <center>
                <img src="http://i2.wp.com/www.casadecat.com/wp-content/uploads/2015/12/%E0%B8%AB%E0%B9%89%E0%B8%AD%E0%B8%87-standard-s.jpg?zoom=1.5&fit=900%2C900" style="width:60%" />
            </center>
            <br />
        </div>
        <div class="row col-md-6">
            <br />
            <div>
                <form class="form-inline">
                    <div class="col-md-12 form-group">
                        <span style="padding: 0 20px"></span>
                        <span> Check In </span>
                        <span style="padding: 0 30px"></span>
                        <input class="form-control" style="padding-left:5em" type="date" id="checkinDate" onchange="myFunction()" />
                    </div>
                </form>
                <br /><br />
                <form class="form-inline">
                    <div class="col-md-12 form-group">
                        <span style="padding: 0 20px"></span>
                        <span> Check Out </span>
                        <span style="padding: 0 24px"></span>
                        <input class="form-control" style="padding-left:5em" type="date" id="checkoutDate" onchange="myFunction()" />
                    </div>
                </form>
                <br /><br />
                <form class="form-inline">
                    <div class="col-md-12 form-group">
                        <span style="padding: 0 20px"></span>
                        <span> Guests </span>
                        <span style="padding: 0 35px"></span>
                        <input class="form-control" style="padding-left:3em" type="number" id="guests" value="1" min="1" max="5" placeholder="1 Guest" onchange="myFunction()" />
                    </div>
                </form>
                <div class="col-md-12">
                    <br />
                    <span style="padding: 0 20px"></span>
                    @price ฿ x <span id="diff"> @timedDiff </span> days = <span id="price"> @price </span> ฿ <br />
                    <span style="padding: 0 20px"></span>
                    Total: <span id="price_total"> @price </span> ฿    
                </div>  <br />
                <span style="padding: 0 85px"></span>
                <input type="button" class="btn btn-default" value="Book Now" onclick="location.href='@Url.Action("BookingSuccess", "Book" )'" />
            </div>
            <br />
            <script type="text/javascript">
                var today = new Date();
                var dd = today.getDate();
                var mm = today.getMonth()+1; //January is 0!
                var yyyy = today.getFullYear();
                if(dd<10){
                    dd='0'+dd
                } 
                if(mm<10){
                    mm='0'+mm
                } 

                today = yyyy+'-'+mm+'-'+dd;
                document.getElementById("checkinDate").setAttribute("min", today);
                document.getElementById("checkoutDate").setAttribute("min", today);

                document.getElementById('checkinDate').valueAsDate = new Date();
                document.getElementById('checkoutDate').valueAsDate = new Date();
                
                var chkInDate;
                var chkOutDate;
                var totalGuests;
                var timeDiff = @timedDiff;
                var price = @price;
                myFunction = function () {
                    chkInDate = new Date(document.getElementById("checkinDate").value);
                    chkOutDate = new Date(document.getElementById("checkoutDate").value);
                    totalGuests = (document.getElementById("guests").value);
                    
                    timeDiff = Math.abs(chkOutDate.getTime() - chkInDate.getTime());
                    diffDays = Math.ceil(timeDiff / (1000 * 3600 * 24));
                    if (chkOutDate.getTime() > chkInDate.getTime()) {
                        price = @price * diffDays;             
                    }else if(chkOutDate.getTime() == chkInDate.getTime()){
                        diffDays = @timedDiff;
                        price = @price;
                    }else if(chkOutDate.getTime() < chkInDate.getTime()){
                        diffDays = @timedDiff;
                        document.getElementById('checkoutDate').valueAsDate = document.getElementById('checkinDate').valueAsDate;
                    }
                    document.getElementById("diff").innerHTML = diffDays;
                    document.getElementById("price").innerHTML = price;
                    document.getElementById("price_total").innerHTML = price * totalGuests;
                }
            </script>
        </div>
        <br />
        <div>
            <center>
                <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3875.700102502874!2d100.51523771372936!3d13.736597901349164!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x30e29927c1c8370f%3A0xd89b4365c21f7b46!2z4LmC4Lij4LiH4LmB4Lij4Lih4LmB4Lih4LinIENhc2EgZGUgQ2F0!5e0!3m2!1sen!2sth!4v1503087748731" width="900" height="400" frameborder="0" style="border:0" allowfullscreen></iframe>
            </center>
            <br />
        </div>
    </div>
</body>
</html>
